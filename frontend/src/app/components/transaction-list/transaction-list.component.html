<div class="transaction-list-container">
  
  <!-- Loading state -->
  <div *ngIf="isLoading" class="text-center p-md">
    <div class="spinner spinner-md"></div>
    <p class="mt-sm">Cargando transacciones...</p>
  </div>

  <!-- Empty state -->
  <div *ngIf="!isLoading && (!transactions || transactions.length === 0)" class="text-center p-md">
    <p class="text-muted mb-md">No hay transacciones en esta cuenta</p>
    <button class="btn btn-primary" (click)="onAddTransaction()">
      â• AÃ±adir primera transacciÃ³n
    </button>
  </div>

  <!-- Transaction list with improved architecture -->
  <div *ngIf="!isLoading && transactions && transactions.length > 0" class="transactions-list-container">
    
    <!-- Individual transaction card -->
    <div 
      *ngFor="let transaction of transactions; let i = index"
      (click)="onViewDetails(transaction.id)"
      class="transaction-card-container">
      
      <!-- Transaction card content -->
      <div class="transaction-card-content">
        
        <!-- Icon block -->
        <div class="transaction-icon-block">
          <div class="transaction-icon" 
               [class.income]="transaction.type === 'INCOME'"
               [class.expense]="transaction.type === 'EXPENSE'">
            {{ transaction.category.icon }}
          </div>
        </div>
        
        <!-- Details block -->
        <div class="transaction-details-block">
          <h4 class="transaction-title">{{ transaction.title }}</h4>
          <p class="transaction-category-name">{{ transaction.category.name }}</p>
        </div>
        
        <!-- Amount and date block -->
        <div class="transaction-amount-block">
          <p class="transaction-amount" 
             [class.income]="transaction.type === 'INCOME'"
             [class.expense]="transaction.type === 'EXPENSE'">
            {{ transaction.type === 'INCOME' ? '+' : '-' }}{{ transaction.amount | number:'1.2-2' }} â‚¬
          </p>
          <p class="transaction-date">{{ transaction.date | date:'dd/M, HH:mm' }}</p>
        </div>
        
        <!-- Actions block - DENTRO del grid -->
        <div class="transaction-actions-block">
          <button class="btn btn-xs btn-outline-primary" (click)="onEditTransaction(transaction.id)" title="Editar">
            âœï¸
          </button>
          <button class="btn btn-xs btn-danger" (click)="onDeleteTransaction(transaction.id)" title="Eliminar">
            ğŸ—‘ï¸
          </button>
        </div>
        
      </div>
      
    </div>

  </div>
  
  <!-- Add more transactions when list is not empty -->
  <div *ngIf="!isLoading && transactions && transactions.length > 0" class="mt-md text-center">
    <button class="btn btn-primary" (click)="onAddTransaction()">
      â• AÃ±adir TransacciÃ³n
    </button>
    
    <!-- Show more button -->
    <div *ngIf="hasMoreTransactions" class="mt-sm">
      <button class="btn btn-secondary btn-sm" (click)="onViewAllTransactions()">
        Ver todas las transacciones
      </button>
    </div>
  </div>
  
</div>